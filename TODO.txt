1/ add back propagation to code